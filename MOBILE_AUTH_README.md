# å¾®ä¿¡è¯»ä¹¦ç§»åŠ¨ç«¯è®¤è¯è®¾ç½®æŒ‡å—

## èƒŒæ™¯è¯´æ˜

å¾®ä¿¡è¯»ä¹¦çš„æ–°API (`https://i.weread.qq.com/readdata/detail`) éœ€è¦ç§»åŠ¨ç«¯çš„è®¤è¯ä¿¡æ¯ï¼Œè€Œä¸æ˜¯ç½‘é¡µç«¯çš„cookieã€‚

## è·å–è®¤è¯ä¿¡æ¯çš„æ–¹æ³•

### æ–¹æ³•1: ä½¿ç”¨æŠ“åŒ…å·¥å…·
1. åœ¨æ‰‹æœºä¸Šå®‰è£…æŠ“åŒ…å·¥å…·ï¼ˆå¦‚Charlesã€mitmproxyç­‰ï¼‰
2. é…ç½®æ‰‹æœºä»£ç†åˆ°ç”µè„‘
3. åœ¨å¾®ä¿¡è¯»ä¹¦Appä¸­è¿›è¡Œæ“ä½œ
4. æŠ“å– `https://i.weread.qq.com/readdata/detail` çš„è¯·æ±‚
5. ä»è¯·æ±‚å¤´ä¸­æå– `vid` å’Œ `skey` çš„å€¼

### æ–¹æ³•2: ä»Appå­˜å‚¨ä¸­æå–
- iOS: ä½¿ç”¨å·¥å…·æŸ¥çœ‹å¾®ä¿¡è¯»ä¹¦Appçš„æ•°æ®å­˜å‚¨
- Android: æŸ¥çœ‹Appçš„æ•°æ®ç›®å½•

## è®¾ç½®è®¤è¯ä¿¡æ¯

### æ–¹å¼1: ä½¿ç”¨ç¯å¢ƒå˜é‡
```bash
export WEREAD_VID="ä½ çš„vidå€¼"
export WEREAD_SKEY="ä½ çš„skeyå€¼"
```

### æ–¹å¼2: ä½¿ç”¨è®¾ç½®è„šæœ¬
```bash
./set_mobile_auth.sh
```

### æ–¹å¼3: ç›´æ¥åœ¨ä»£ç ä¸­è®¾ç½®
ä¿®æ”¹ `weread2notionpro/weread_api.py` ä¸­çš„ `get_readtiming_detail_data` æ–¹æ³•ï¼š
```python
# ç›´æ¥è®¾ç½®è®¤è¯ä¿¡æ¯
vid = "ä½ çš„vidå€¼"
skey = "ä½ çš„skeyå€¼"
```

## æµ‹è¯•éªŒè¯

è®¾ç½®å¥½è®¤è¯ä¿¡æ¯åï¼Œè¿è¡Œæµ‹è¯•ï¼š
```bash
python tests/test_new_get_api_data.py
```

æˆåŠŸæ—¶åº”è¯¥çœ‹åˆ°ï¼š
```
âœ… è¯¦ç»†API è°ƒç”¨æˆåŠŸ
ğŸ“Š é˜…è¯»æ•°æ®ç‚¹æ•°: X
æ€»é˜…è¯»æ—¶é—´: XXX åˆ†é’Ÿ
```

## æ³¨æ„äº‹é¡¹

1. ç§»åŠ¨ç«¯è®¤è¯ä¿¡æ¯å¯èƒ½æœ‰æœ‰æ•ˆæœŸï¼Œéœ€è¦å®šæœŸæ›´æ–°
2. ä¸åŒè®¾å¤‡å’Œè´¦æˆ·çš„è®¤è¯ä¿¡æ¯ä¸åŒ
3. ç¡®ä¿ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„å¾®ä¿¡è¯»ä¹¦Appè¿›è¡ŒæŠ“åŒ…

## APIæ•°æ®ç»“æ„

æ–°APIè¿”å›çš„å®Œæ•´æ•°æ®ç»“æ„ï¼š
- `readTimes`: æ—¥æœŸæ—¶é—´æˆ³ -> é˜…è¯»åˆ†é’Ÿæ•°
- `readDays`: æ€»é˜…è¯»å¤©æ•°
- `totalReadTime`: æ€»é˜…è¯»æ—¶é—´(åˆ†é’Ÿ)
- `yearReport`: å¹´åº¦æŠ¥å‘Šæ•°æ®
- `preferBooks`: åå¥½ä¹¦ç±åˆ—è¡¨
- `preferCategory`: åå¥½åˆ†ç±»ç»Ÿè®¡
- `preferAuthor`: åå¥½ä½œè€…ç»Ÿè®¡
- `medals`: å‹‹ç« æˆå°±
- `readStat`: é˜…è¯»ç»Ÿè®¡æ¦‚è§ˆ
- `shareInfo`: åˆ†äº«ä¿¡æ¯